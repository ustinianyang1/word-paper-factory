# Word文档自动生成器

一个基于React + TypeScript的Word文档自动生成工具，支持自定义格式设置，一键生成符合学术规范的Word文档。

## 功能特性

- 📝 **文档信息管理**：输入题目、自定义个人信息项
- 📄 **内容编辑**：编辑摘要、关键词、引言、正文、结论、参考文献
- 📚 **脚注支持**：支持添加和管理脚注
- 🎨 **格式自定义**：可自定义所有元素的字体、字号、对齐方式、行距等
- 👁️ **实时预览**：实时预览文档效果，自动隐藏空内容部分
- 💾 **配置保存**：支持导出和导入格式配置
- 📥 **一键生成**：生成符合命名规则的Word文档

## 默认格式规范

| 元素       | 字体            | 字号         | 样式 | 对齐     | 行距  |
| ---------- | --------------- | ------------ | ---- | -------- | ----- |
| 题目       | 宋体            | 三号(16pt)   | 加粗 | 居中     | -     |
| 个人信息   | 宋体            | 五号(10.5pt) | 常规 | 居中     | -     |
| 摘要标题   | 黑体            | 四号(14pt)   | 常规 | 居中     | -     |
| 摘要内容   | 宋体            | 小四号(12pt) | 常规 | 两端对齐 | -     |
| 关键词标题 | 黑体            | 小四号(12pt) | 常规 | 顶格     | -     |
| 关键词内容 | 宋体            | 小四号(12pt) | 常规 | 两端对齐 | -     |
| 引言标题   | 黑体            | 小四号(12pt) | 加粗 | 居中     | -     |
| 引言内容   | 宋体            | 小四号(12pt) | 常规 | 两端对齐 | 1.5倍 |
| 正文(中文) | 宋体            | 小四号(12pt) | 常规 | 两端对齐 | 1.5倍 |
| 正文(英文) | Times New Roman | 小四号(12pt) | 常规 | 两端对齐 | 1.5倍 |
| 结论标题   | 黑体            | 小四号(12pt) | 加粗 | 居中     | -     |
| 结论内容   | 宋体            | 小四号(12pt) | 常规 | 两端对齐 | 1.5倍 |
| 参考文献标题 | 黑体            | 小四号(12pt) | 加粗 | 居中     | -     |
| 参考文献内容 | 宋体            | 小四号(12pt) | 常规 | 两端对齐 | 1.5倍 |
| 脚注(中文) | 宋体            | 小五号(9pt)  | 常规 | -        | -     |
| 脚注(英文) | Times New Roman | 小五号(9pt)  | 常规 | -        | -     |

## 快速开始

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

### 构建生产版本

```bash
npm run build
```

### 预览生产构建

```bash
npm run preview
```

## 使用说明

### 1. 填写文档信息

在"文档编辑"标签页中，填写以下信息：

- **题目**：输入论文题目（必填）
- **个人信息**：点击"添加个人信息项"按钮，自定义所需的个人信息（如姓名、学号、专业等），不同项之间用单个空格分隔，整体居中显示
- **摘要**：输入论文摘要内容（可选，最多500字）
- **关键词**：输入关键词，用分号分隔（可选）
- **引言**：输入引言内容（可选）
- **正文内容**：输入正文，支持多行输入（必填）
- **脚注管理**：点击"添加脚注"按钮添加脚注，在正文中使用 `[1]`、`[2]` 等格式标记脚注位置
- **结论**：输入结论内容（可选）
- **参考文献**：输入参考文献，每条参考文献占一行（可选）

### 2. 自定义格式（可选）

在"格式设置"标签页中，可以自定义以下格式：

- **题目格式**：字体、字号、加粗、对齐方式
- **个人信息格式**：字体、字号、对齐方式
- **摘要标题格式**：字体、字号、对齐方式
- **摘要内容格式**：字体、字号、对齐方式、首行缩进
- **关键词标题格式**：字体、字号、对齐方式
- **关键词内容格式**：字体、字号、对齐方式
- **引言标题格式**：字体、字号、加粗、对齐方式
- **引言内容格式**：字体、字号、对齐方式、行距、首行缩进
- **正文格式（中文）**：字体、字号、对齐方式、行距、首行缩进
- **正文格式（英文）**：字体、字号、对齐方式、行距、首行缩进
- **结论标题格式**：字体、字号、加粗、对齐方式
- **结论内容格式**：字体、字号、对齐方式、行距、首行缩进
- **参考文献标题格式**：字体、字号、加粗、对齐方式
- **参考文献内容格式**：字体、字号、对齐方式、行距、首行缩进
- **脚注格式（中文）**：字体、字号
- **脚注格式（英文）**：字体、字号

### 3. 生成文档

点击右上角的"生成并下载文档"按钮，系统将自动生成Word文档并下载，文件名格式为：`题目.docx`

### 4. 导出/导入格式配置

- **导出配置**：点击"导出配置"按钮，可以复制配置到剪贴板或下载为JSON文件
- **导入配置**：点击"导入配置"按钮，粘贴配置JSON；或点击"从文件导入"选择配置文件

### 5. 实时预览

在右侧预览面板中，可以实时查看文档效果。当某个部分（如摘要、关键词、参考文献等）未输入任何内容时，系统会自动隐藏该部分对应的标题，提升文档预览的专业性和可读性。

## 常见问题

### Q1: 如何自定义个人信息项？

**A**: 在"文档编辑"标签页中，点击"添加个人信息项"按钮，可以添加任意数量的个人信息项。每个项包含"标签"和"内容"两个字段。不同项之间会用单个空格分隔，整体居中显示。

### Q2: 为什么预览中某些部分不显示？

**A**: 这是正常的设计。当某个部分（如摘要、关键词、参考文献等）未输入任何内容时，系统会自动隐藏该部分对应的标题，以提升文档预览的专业性和可读性。输入内容后，该部分会自动显示。

### Q3: 如何使用脚注？

**A**: 
1. 在"脚注管理"区域，点击"添加脚注"按钮添加脚注
2. 在正文内容中，使用 `[数字]` 的格式标记脚注位置，如 `[1]`、`[2]` 等
3. 在脚注输入框中填写脚注内容
4. 系统会自动在生成的Word文档中创建脚注

### Q4: 如何保存和恢复格式配置？

**A**: 
1. 在"格式设置"标签页中，自定义好格式后
2. 点击"导出配置"按钮
3. 选择"复制到剪贴板"或"下载文件"保存配置
4. 下次使用时，点击"导入配置"按钮
5. 选择"粘贴配置"或"从文件导入"恢复配置

### Q5: 支持哪些字体和字号？

**A**: 
- **字体**：宋体、黑体、Times New Roman、Arial、微软雅黑
- **字号**：小五(9pt)、五号(10.5pt)、小四(12pt)、四号(14pt)、小三(15pt)、三号(16pt)、小二(18pt)、二号(22pt)、小一(24pt)、一号(26pt)
- **对齐方式**：左对齐、居中、右对齐、两端对齐
- **行距**：1.0倍、1.15倍、1.5倍、2.0倍

### Q6: 生成的Word文档在哪里？

**A**: 生成的Word文档会自动下载到浏览器的默认下载目录。文件名格式为：`题目.docx`

### Q7: 如何调整各部分的间距？

**A**: 在"格式设置"标签页中，可以调整各部分的"间距前"和"间距后"参数，单位为毫米。

### Q8: 预览和生成的文档格式不一致怎么办？

**A**: 
1. 确保在"格式设置"中正确设置了格式
2. 检查预览中是否显示正确
3. 如果问题仍然存在，尝试清除浏览器缓存
4. 检查是否有格式配置冲突

## 贡献指南

我们欢迎任何形式的贡献！如果您想为这个项目做出贡献，请遵循以下步骤：

### 1. Fork 项目

在GitHub上Fork本项目到您的账户。

### 2. 创建特性分支

```bash
git checkout -b feature/your-feature-name
```

### 3. 进行修改

在您的本地进行代码修改，确保：
- 代码遵循项目的代码风格
- 添加必要的注释
- 更新相关文档
- 确保所有测试通过

### 4. 提交更改

```bash
git add .
git commit -m "feat: 添加您的功能描述"
```

### 5. 推送到分支

```bash
git push origin feature/your-feature-name
```

### 6. 创建 Pull Request

在GitHub上创建Pull Request，等待代码审查和合并。

### 代码风格指南

- 使用TypeScript进行类型检查
- 遵循React Hooks最佳实践
- 组件命名使用PascalCase
- 函数命名使用camelCase
- 添加必要的注释说明复杂逻辑
- 保持代码简洁和可读性

### 提交信息规范

使用Conventional Commits规范：
- `feat:` 新功能
- `fix:` 修复bug
- `docs:` 文档更新
- `style:` 代码格式调整
- `refactor:` 代码重构
- `test:` 测试相关
- `chore:` 构建过程或辅助工具的变动

## 技术栈

- **React 18**：用户界面框架
- **TypeScript**：类型安全
- **Vite**：快速构建工具
- **Ant Design**：UI组件库
- **Zustand**：轻量级状态管理
- **docx**：Word文档生成库

## 项目结构

```
word-paper-factory/
├── src/
│   ├── components/          # UI组件
│   │   ├── PaperForm.tsx   # 文档信息表单
│   │   ├── ContentEditor.tsx # 内容编辑器
│   │   ├── FootnoteManager.tsx # 脚注管理组件
│   │   ├── FormatSettings.tsx # 格式设置面板
│   │   └── Preview.tsx     # 预览组件
│   ├── core/               # 核心逻辑
│   │   ├── documentGenerator.ts # Word文档生成器
│   │   └── formatConfig.ts  # 格式配置管理
│   ├── types/              # 类型定义
│   │   ├── paper.ts        # 文档类型
│   │   └── format.ts       # 格式类型
│   ├── store/              # 状态管理
│   │   └── paperStore.ts   # 文档状态
│   ├── utils/              # 工具函数
│   │   └── fontUtils.ts    # 字体转换工具
│   ├── App.tsx             # 主应用组件
│   ├── main.tsx            # 入口文件
│   └── index.css           # 全局样式
├── package.json
├── tsconfig.json
├── vite.config.ts
├── .gitignore
├── README.md
└── QUICKSTART.md
```

## 许可证

MIT

## 联系方式

如有问题或建议，欢迎通过以下方式联系：

- 提交Issue：在GitHub上提交问题
- 发送邮件：[您的邮箱]
- 参与讨论：在GitHub Discussions中参与讨论

---

**注意**：本项目仅用于学术文档生成，请确保您有合法使用生成文档的权利。
